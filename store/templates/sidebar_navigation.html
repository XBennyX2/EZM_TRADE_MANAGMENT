<!-- Role-based Sidebar Navigation Component -->
{% if user.is_authenticated %}

<!-- Admin Sidebar -->
{% if user.is_superuser or user.role == 'admin' %}
<ul>
    <li class="sidebar-menu-item">
        <a href="{% url 'admin_dashboard' %}" data-tooltip="Dashboard">
            <i class="bi bi-speedometer2"></i>
            <span>Dashboard</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'manage_users' %}" data-tooltip="User Management">
            <i class="bi bi-people"></i>
            <span>User Management</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'admin_login_logs' %}" data-tooltip="Login Logs">
            <i class="bi bi-shield-check"></i>
            <span>Login Logs</span>
        </a>
    </li>
</ul>

<!-- Head Manager Sidebar -->
{% elif user.role == 'head_manager' %}
<ul>
    <li class="sidebar-menu-item">
        <a href="{% url 'head_manager_page' %}" data-tooltip="Dashboard">
            <i class="bi bi-speedometer2"></i>
            <span>Dashboard</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'warehouse_list' %}" data-tooltip="Warehouse Management">
            <i class="bi bi-building"></i>
            <span>Warehouse Management</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'product_list' %}" data-tooltip="Products">
            <i class="bi bi-box-seam"></i>
            <span>Products</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'supplier_list' %}" data-tooltip="Suppliers">
            <i class="bi bi-truck"></i>
            <span>Suppliers</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'purchase_order_list' %}" data-tooltip="Purchase Orders">
            <i class="bi bi-cart-check"></i>
            <span>Purchase Orders</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'showroom_list' %}" data-tooltip="Store Manager Assignment">
            <i class="bi bi-shop"></i>
            <span>Store Manager Assignment</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'financial_reports' %}" data-tooltip="Financial Reports">
            <i class="bi bi-bar-chart"></i>
            <span>Financial Reports</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'head_manager_restock_requests' %}" data-tooltip="Restock Requests">
            <i class="bi bi-arrow-up-circle"></i>
            <span>Restock Requests</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'analytics_dashboard' %}" data-tooltip="Analytics Dashboard">
            <i class="bi bi-graph-up-arrow"></i>
            <span>Analytics Dashboard</span>
        </a>
    </li>
</ul>

<!-- Store Manager Sidebar -->
{% elif user.role == 'store_manager' %}
<ul>
    <li class="sidebar-menu-item">
        <a href="{% url 'store_manager_page' %}" data-tooltip="Dashboard">
            <i class="bi bi-speedometer2"></i>
            <span>Dashboard</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'store_product_list' %}" data-tooltip="Products">
            <i class="bi bi-box-seam"></i>
            <span>Products</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'store_manager_stock_management' %}" data-tooltip="Stock Management">
            <i class="bi bi-boxes"></i>
            <span>Stock Management</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'stock_alerts_dashboard' %}" data-tooltip="Stock Alerts Dashboard">
            <i class="bi bi-exclamation-triangle"></i>
            <span>Stock Alerts</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'stock_alerts_dashboard' %}?filter=low_stock" data-tooltip="Manage Low Stocks">
            <i class="bi bi-exclamation-circle"></i>
            <span>Manage Low Stocks</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'stock_alerts_dashboard' %}?filter=out_of_stock" data-tooltip="Out of Stock Items">
            <i class="bi bi-x-circle"></i>
            <span>Out of Stock</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'manage_cashiers' %}" data-tooltip="Manage Cashiers">
            <i class="bi bi-people"></i>
            <span>Manage Cashiers</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'store_manager_restock_requests' %}" data-tooltip="Restock Requests">
            <i class="bi bi-arrow-up-circle"></i>
            <span>Restock Requests</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'store_manager_transfer_requests' %}" data-tooltip="Transfer Requests">
            <i class="bi bi-arrow-left-right"></i>
            <span>Transfer Requests</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'store_sales_report' %}" data-tooltip="Sales Reports">
            <i class="bi bi-graph-up"></i>
            <span>Sales Reports</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'store_manager_stock_management' %}" data-tooltip="Stock Management">
            <i class="bi bi-clipboard-data"></i>
            <span>Stock Operations</span>
        </a>
    </li>
</ul>

<!-- Cashier Sidebar -->
{% elif user.role == 'cashier' %}
<ul>
    <li class="sidebar-menu-item">
        <a href="{% url 'initiate_order' %}" data-tooltip="Point of Sale Dashboard">
            <i class="bi bi-cash-register"></i>
            <span>Point of Sale</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'ticket_management' %}" data-tooltip="Customer Tickets Management">
            <i class="bi bi-ticket-perforated"></i>
            <span>Customer Tickets</span>
        </a>
    </li>
    <li class="sidebar-menu-item">
        <a href="{% url 'cashier_transactions' %}" data-tooltip="Transaction Details">
            <i class="bi bi-receipt"></i>
            <span>Transaction Details</span>
        </a>
    </li>
</ul>

<!-- Default/Customer Sidebar -->
{% else %}
<ul>
    <li class="sidebar-menu-item">
        <a href="{% url 'login' %}" data-tooltip="Home">
            <i class="bi bi-house-door"></i>
            <span>Home</span>
        </a>
    </li>
</ul>
{% endif %}

{% else %}
<!-- Not authenticated sidebar -->
<ul>
    <li class="sidebar-menu-item">
        <a href="{% url 'login' %}" data-tooltip="Login">
            <i class="bi bi-box-arrow-in-right"></i>
            <span>Login</span>
        </a>
    </li>
</ul>
{% endif %}

<!-- JavaScript for active sidebar highlighting -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Get current URL path
    const currentPath = window.location.pathname;

    // Find all sidebar menu links
    const sidebarLinks = document.querySelectorAll('.sidebar-menu-item a');

    // Remove any existing active classes
    sidebarLinks.forEach(link => {
        link.classList.remove('active');
        link.parentElement.classList.remove('active');
    });

    // Find and highlight the current page link
    sidebarLinks.forEach(link => {
        const linkPath = new URL(link.href).pathname;

        // Exact match or if current path starts with link path (for sub-pages)
        if (currentPath === linkPath || (linkPath !== '/' && currentPath.startsWith(linkPath))) {
            link.classList.add('active');
            link.parentElement.classList.add('active');
        }
    });

    // Special handling for dashboard pages
    if (currentPath.includes('/store-manager/') && !document.querySelector('.sidebar-menu-item.active')) {
        const dashboardLink = document.querySelector('a[href*="store-manager"]');
        if (dashboardLink) {
            dashboardLink.classList.add('active');
            dashboardLink.parentElement.classList.add('active');
        }
    }
});
</script>