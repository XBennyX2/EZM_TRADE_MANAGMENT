{% extends 'base_sidebar.html' %}
{% load static %}

{% block title %}Create New Sales Person{% endblock %}
{% block page_title %}Create New Sales Person{% endblock %}

{% block sidebar_menu %}
{% include 'sidebar_navigation.html' %}
{% endblock %}

{% block content %}
<div class="container-fluid">
  <!-- Messages -->
  {% if messages %}
  {% for message in messages %}
  <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
    {{ message }}
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>
  {% endfor %}
  {% endif %}

  <div class="row justify-content-center">
    <div class="col-lg-8 col-md-10">
      <div class="ezm-card">
        <div class="ezm-card-header">
          <i class="bi bi-person-plus me-2"></i>Create New Sales Person for {{ store.name }}
        </div>
        <div class="card-body">
          <form method="post">
            {% csrf_token %}
            
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="username" class="form-label">Username <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="username" name="username" 
                         placeholder="Enter username" required>
                  <small class="text-muted">Must be unique across the system</small>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="email" class="form-label">Email Address <span class="text-danger">*</span></label>
                  <input type="email" class="form-control" id="email" name="email" 
                         placeholder="Enter email address" required>
                  <small class="text-muted">Must be unique across the system</small>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="first_name" class="form-label">First Name</label>
                  <input type="text" class="form-control" id="first_name" name="first_name" 
                         placeholder="Enter first name">
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="last_name" class="form-label">Last Name</label>
                  <input type="text" class="form-control" id="last_name" name="last_name" 
                         placeholder="Enter last name">
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="phone_number" class="form-label">Phone Number</label>
                  <input type="tel" class="form-control" id="phone_number" name="phone_number" 
                         placeholder="Enter phone number">
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="password" class="form-label">Password <span class="text-danger">*</span></label>
                  <input type="password" class="form-control" id="password" name="password" 
                         placeholder="Enter password" required>
                  <small class="text-muted">Must be at least 8 characters long</small>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="confirm_password" class="form-label">Confirm Password <span class="text-danger">*</span></label>
                  <input type="password" class="form-control" id="confirm_password" name="confirm_password" 
                         placeholder="Confirm password" required>
                  <small class="text-muted">Must match the password above</small>
                </div>
              </div>
            </div>

            <div class="alert alert-info">
              <i class="bi bi-info-circle me-2"></i>
              <strong>Note:</strong> The new sales person will be automatically assigned to your store ({{ store.name }})
              and will be required to change their password on first login.
            </div>

            <div class="d-flex gap-3 mt-4">
              <button type="submit" class="btn btn-ezm-primary">
                <i class="bi bi-person-plus me-2"></i>Create Sales Person
              </button>
              <a href="{% url 'manage_cashiers' %}" class="btn btn-ezm-secondary">
                <i class="bi bi-arrow-left me-2"></i>Back to Salespersons
              </a>
            </div>
          </form>
        </div>
      </div>

      <!-- Password Requirements -->
      <div class="ezm-card mt-4">
        <div class="ezm-card-header">
          <i class="bi bi-shield-check me-2"></i>Password Requirements
        </div>
        <div class="card-body">
          <ul class="mb-0">
            <li>At least 8 characters long</li>
            <li>Must be confirmed by typing it twice</li>
            <li>Cashier will be required to change password on first login</li>
            <li>Should be secure and not easily guessable</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const password = document.getElementById('password');
    const confirmPassword = document.getElementById('confirm_password');
    
    function validatePasswords() {
        if (password.value && confirmPassword.value) {
            if (password.value !== confirmPassword.value) {
                confirmPassword.setCustomValidity('Passwords do not match');
            } else {
                confirmPassword.setCustomValidity('');
            }
        }
    }
    
    password.addEventListener('input', validatePasswords);
    confirmPassword.addEventListener('input', validatePasswords);
});
</script>
{% endblock %}
