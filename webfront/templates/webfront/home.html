{% extends 'webfront/webfront_base.html' %}
{% load webfront_extras %}

{% block title %}Welcome to EZM Trade - Quality Products Across Multiple Locations{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h1>Welcome to EZM Trade</h1>
                <p>Discover quality products across our multiple store locations. Browse our extensive inventory, check real-time availability, and find exactly what you need.</p>
                <div class="mt-4">
                    <a href="#store-selection" class="btn btn-primary-custom btn-lg me-3">
                        <i class="bi bi-cart-plus me-2"></i>Start Shopping
                    </a>
                    <a href="{% url 'webfront:stock_list' %}" class="btn btn-outline-light btn-lg me-3">
                        <i class="bi bi-search me-2"></i>Browse All Products
                    </a>
                    <a href="#features" class="btn btn-outline-light btn-lg">
                        <i class="bi bi-info-circle me-2"></i>Learn More
                    </a>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="row g-3 mt-4 mt-lg-0">
                    <div class="col-6">
                        <div class="info-card text-center bg-white bg-opacity-10 text-white p-4">
                            <div class="display-4 fw-bold">{{ total_products }}</div>
                            <div class="mt-2">Products Available</div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="info-card text-center bg-white bg-opacity-10 text-white p-4">
                            <div class="display-4 fw-bold">{{ total_stores }}</div>
                            <div class="mt-2">Store Locations</div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="info-card text-center bg-white bg-opacity-10 text-white p-4">
                            <div class="display-4 fw-bold">{{ total_stock_items }}</div>
                            <div class="mt-2">Items in Stock</div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="info-card text-center bg-white bg-opacity-10 text-white p-4">
                            <div class="display-4 fw-bold text-warning">{{ low_stock_items }}</div>
                            <div class="mt-2">Low Stock Items</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section id="features" class="content-section">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="section-title">Why Choose EZM Trade?</h2>
            <p class="lead text-muted">Experience the convenience of browsing our complete inventory online</p>
        </div>

        <div class="row g-4">
            <div class="col-md-4">
                <div class="info-card text-center h-100">
                    <div class="card-body p-4">
                        <div class="bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-4" style="width: 80px; height: 80px;">
                            <i class="bi bi-search fs-1 text-primary"></i>
                        </div>
                        <h4 class="mb-3">Easy Product Search</h4>
                        <p class="text-muted">Quickly find products across all our store locations with powerful search and filtering options.</p>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="info-card text-center h-100">
                    <div class="card-body p-4">
                        <div class="bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-4" style="width: 80px; height: 80px;">
                            <i class="bi bi-buildings fs-1 text-success"></i>
                        </div>
                        <h4 class="mb-3">Multiple Locations</h4>
                        <p class="text-muted">Compare availability and prices across different store locations to find the best option for you.</p>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="info-card text-center h-100">
                    <div class="card-body p-4">
                        <div class="bg-info bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-4" style="width: 80px; height: 80px;">
                            <i class="bi bi-clock fs-1 text-info"></i>
                        </div>
                        <h4 class="mb-3">Real-time Updates</h4>
                        <p class="text-muted">Get up-to-date information on product availability, pricing, and stock levels.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Recent Updates Section -->
<section class="content-section bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="section-title">Recent Stock Updates</h2>
            <p class="lead text-muted">Stay updated with our latest inventory changes</p>
        </div>

        {% if recent_updates %}
        <div class="row g-4">
            {% for stock in recent_updates %}
            <div class="col-md-6 col-lg-4">
                <div class="info-card">
                    <div class="card-body p-4">
                        <div class="d-flex align-items-start">
                            <div class="bg-primary bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 50px; height: 50px;">
                                <i class="bi bi-box fs-4 text-primary"></i>
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="mb-1">{{ stock.product.name }}</h6>
                                <p class="text-muted mb-2 small">{{ stock.store.name }}</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="badge {% if stock.quantity <= stock.low_stock_threshold %}bg-danger{% elif stock.quantity <= 50 %}bg-warning{% else %}bg-success{% endif %}">
                                        {{ stock.quantity }} units
                                    </span>
                                    <small class="text-muted">ETB {{ stock.selling_price }}</small>
                                </div>
                                <div class="mt-2">
                                    <a href="{% url 'webfront:stock_detail' stock.id %}" class="btn btn-outline-primary btn-sm">
                                        View Details
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="text-center">
            <div class="bg-light rounded p-5">
                <i class="bi bi-clock fs-1 text-muted mb-3 d-block"></i>
                <h5 class="text-muted">No recent updates available</h5>
                <p class="text-muted">Check back later for the latest inventory changes.</p>
            </div>
        </div>
        {% endif %}
    </div>
</section>

<!-- Top Stores and Categories -->
<section class="content-section">
    <div class="container">
        <div class="row">
            <!-- Top Stores -->
            <div class="col-lg-6 mb-4">
                <h3 class="mb-4"><i class="bi bi-building me-2"></i>Our Store Locations</h3>
                {% if stores_with_stock %}
                    {% for store in stores_with_stock %}
                    <div class="info-card mb-3">
                        <div class="card-body p-4">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h5 class="mb-1">{{ store.name }}</h5>
                                    <p class="text-muted mb-0">
                                        <i class="bi bi-geo-alt me-1"></i>{{ store.address|default:"Store Location" }}
                                    </p>
                                </div>
                                <div class="text-end">
                                    <div class="badge bg-primary fs-6 px-3 py-2">
                                        {{ store.stock_count }} Products
                                    </div>
                                    <div class="mt-2">
                                        <a href="{% url 'webfront:store_stock' store.id %}" class="btn btn-outline-primary btn-sm">
                                            Visit Store
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="info-card">
                        <div class="card-body p-4 text-center">
                            <i class="bi bi-building fs-1 text-muted mb-3 d-block"></i>
                            <h5 class="text-muted">No stores available</h5>
                        </div>
                    </div>
                {% endif %}
            </div>

            <!-- Top Categories -->
            <div class="col-lg-6 mb-4">
                <h3 class="mb-4"><i class="bi bi-tags me-2"></i>Popular Categories</h3>
                {% if top_categories %}
                    {% for category in top_categories %}
                    <div class="info-card mb-3">
                        <div class="card-body p-4">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h5 class="mb-1">{{ category.category }}</h5>
                                    <p class="text-muted mb-0">
                                        {{ category.product_count }} product{{ category.product_count|pluralize }}
                                    </p>
                                </div>
                                <div class="text-end">
                                    <div class="badge bg-success fs-6 px-3 py-2">
                                        {{ category.total_stock }} in Stock
                                    </div>
                                    <div class="mt-2">
                                        <a href="{% url 'webfront:stock_list' %}?category={{ category.category }}" class="btn btn-outline-success btn-sm">
                                            Browse Category
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="info-card">
                        <div class="card-body p-4 text-center">
                            <i class="bi bi-tags fs-1 text-muted mb-3 d-block"></i>
                            <h5 class="text-muted">No categories available</h5>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- Store Selection Section -->
<section id="store-selection" class="content-section bg-light">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="text-center mb-5">
                    <h2 class="section-title">Choose Your Store Location</h2>
                    <p class="lead text-muted">Select the store location closest to you to start shopping. This will help us show you the most relevant products and availability.</p>
                </div>

                {% if stores_with_stock %}
                <div class="row g-4">
                    {% for store in stores_with_stock %}
                    <div class="col-md-6 col-lg-4">
                        <div class="info-card h-100 text-center store-selection-card">
                            <div class="card-body p-4">
                                <div class="mb-3">
                                    <div class="bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 80px; height: 80px;">
                                        <i class="bi bi-building fs-1 text-primary"></i>
                                    </div>
                                </div>
                                <h5 class="card-title mb-3">{{ store.name }}</h5>
                                <p class="card-text text-muted mb-3">
                                    <i class="bi bi-geo-alt me-1"></i>{{ store.address|default:"Store Location" }}
                                </p>
                                {% if store.phone %}
                                <p class="card-text text-muted mb-3">
                                    <i class="bi bi-telephone me-1"></i>{{ store.phone }}
                                </p>
                                {% endif %}
                                <div class="badge bg-primary mb-3 fs-6 px-3 py-2">
                                    {{ store.stock_count }} Products Available
                                </div>
                                <div class="mt-3">
                                    <a href="{% url 'webfront:store_stock' store.id %}" class="btn btn-primary-custom">
                                        <i class="bi bi-cart-plus me-1"></i>Shop Here
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="text-center">
                    <div class="bg-white rounded p-5">
                        <i class="bi bi-building fs-1 text-muted mb-3 d-block"></i>
                        <h5 class="text-muted">No stores available</h5>
                        <p class="text-muted">Please check back later or browse all products.</p>
                        <a href="{% url 'webfront:stock_list' %}" class="btn btn-primary-custom">
                            <i class="bi bi-grid me-2"></i>Browse All Products
                        </a>
                    </div>
                </div>
                {% endif %}

                <div class="text-center mt-5">
                    <p class="text-muted mb-3">Or browse products from all locations</p>
                    <a href="{% url 'webfront:stock_list' %}" class="btn btn-outline-primary">
                        <i class="bi bi-grid me-2"></i>Browse All Products
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Call to Action -->
<section class="content-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center">
                <h2 class="section-title">Ready to Start Shopping?</h2>
                <p class="lead text-muted mb-4">Choose your preferred store location and start adding items to your cart for a personalized shopping experience.</p>
                <a href="#store-selection" class="btn btn-primary-custom btn-lg me-3">
                    <i class="bi bi-cart-plus me-2"></i>Start Shopping
                </a>
                <a href="{% url 'webfront:stock_list' %}" class="btn btn-outline-primary btn-lg">
                    <i class="bi bi-grid me-2"></i>Browse All Products
                </a>
            </div>
        </div>
    </div>
</section>


<!-- Recent Updates -->
<section class="content-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 text-center mb-5">
                <h2 class="section-title">Recent Stock Updates</h2>
                <p class="lead text-muted">Latest inventory changes across our stores</p>
            </div>
        </div>
        
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="table-custom">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Store</th>
                                    <th>Quantity</th>
                                    <th>Status</th>
                                    <th>Updated</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for stock in recent_updates %}
                                <tr>
                                    <td>
                                        <strong>{{ stock.product.name }}</strong>
                                        {% if stock.product.variation %}
                                            <br><small class="text-muted">{{ stock.product.variation }}</small>
                                        {% endif %}
                                    </td>
                                    <td>
                                        <a href="{% url 'webfront:store_stock' stock.store.id %}" class="text-decoration-none">
                                            {{ stock.store.name }}
                                        </a>
                                    </td>
                                    <td>
                                        <span class="fw-bold">{{ stock.quantity }}</span>
                                    </td>
                                    <td>
                                        {% if stock.quantity <= stock.low_stock_threshold %}
                                            <span class="status-badge status-low-stock">Low Stock</span>
                                        {% elif stock.quantity <= 50 %}
                                            <span class="status-badge status-medium-stock">Medium</span>
                                        {% else %}
                                            <span class="status-badge status-in-stock">In Stock</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        <small class="text-muted">{{ stock.last_updated|timesince }} ago</small>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="text-center mt-4">
                    <a href="{% url 'webfront:stock_list' %}" class="btn btn-primary-custom">
                        <i class="bi bi-arrow-right"></i> View All Stock
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Call to Action -->
<section class="content-section bg-primary text-white">
    <div class="container text-center">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <h2 class="mb-4">Ready to Explore Our Inventory?</h2>
                <p class="lead mb-4">Start browsing our complete stock information across all store locations.</p>
                <a href="#store-selection" class="btn btn-light btn-lg me-3">
                    <i class="bi bi-cart-plus me-2"></i>Start Shopping Now
                </a>
                <a href="{% url 'webfront:stock_list' %}" class="btn btn-outline-light btn-lg">
                    <i class="bi bi-search me-2"></i>Browse All Products
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}
